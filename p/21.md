---
layout: default
title: Леса, деревья, остовы
---

# {{ page.title }}

**Лес** - ациклический граф (граф без циклов). Лес не содержит петель и кратных ребер (по определению ацикличности), следователно являсетя *обыкновенным* графом

**Дерево** - связный ациклический граф

&nbsp;

<u>Теорема 2.1</u>

Для $(n,m)$-графа $G$ следующие условия являются эквивалентными:

1. $G$ - дерево

2. $G$ - связный граф и $m = n - 1$

3. $G$ - ациклический граф и $m = n - 1$

4. $G$ - граф, в котором две любые вершины соединены единственной простой цепью

5. $G$ - ациклический граф, и добавление нового ребра приводит к появлению точно одного цикла

<u>Док-во:</u>

$1) \implies 2)$

То что граф окажется связным, следует из определения дерева. Докажем индукцией по $m$, что $m = n - 1$:

<u>Б.И.</u>($m = 0$)

Очевидно, что $n = 1$

<u>Ш.И.</u>

Рассмотрим некоторое ребро $e$ дерева $G$. Оно будет ацикличным, а значит мостом (Лемма #4). При удалении ребра $e$, граф G распадется на две компоненты связности $(n_1, m_1)$-граф $G_1$ и $(n_2, m_2)$-граф $G_2$.

Так как $m_1 < m$ И $m_2 < m$, то по предположению индукции $m_1 = n_1 - 1$ и $m_2 = n_2 - 1$.
Имеет место следущее равенство:

$$
m = m_1 + m_2 + 1 = (n_1 - 1) + (n_2 - 1) + 1 = n_1 + n_2 - 1 = n - 1
$$

$2) \implies 3)$

(о/п)

Пусть граф $G$ содержит циклическое ребро $e$. Удалим это ребро, получив $(n, m-1)$-граф $G_1$.
Граф $G_1$ является <u>связным</u> графом. В силу следствия 2 теоремы 1.1:  $\,m - 1 \ge n - 1$. Но $m - 1 = n - 2$ (по исходным данным). Противоречие

$3) \implies 4)$

Докажем сначала, что $G$ - связный граф.

Поскольку $G$ - ацикличен, то его компоненты связности являются деревьями. Значит, в каждой компоненте связности: $m_k = n_k - 1$ (по $1 \implies 2$).
Просуммируем все ребра компоненты связности $G$:

$$
m = m_1 + m_2 + \cdots + m_k = (n_1 - 1) + (n_2 - 2) + \cdots + (n_k - 1) = n - k
$$

Так как $m = n - 1$ (дано), то $k=1$, а значит $G$ - связный

Раз $G$ связный, то $\forall u,v \in VG$ существует $(u,v)$-маршрут, а значит и простая $(u,v)$
-цепь (Лемма #1 - 12.md). Осталось доказать единственность.

(о/п)

Пусть существует 2 простые $(u,v)$-цепи: $P_1$ и $P_2$. Пусть $Q$ - простая $(u,x)$-цепь, которая является самым длинным общим началом цепей $P_1$ и $P_2$. Обозначим через $y,z$ вершины, следующее за вершиной $x$ в цепях $P_1$ и $P_2$ соответственно.
Пусть $f=xz$. Из построения очевидно, что граф $P_1 \cup P_2 - f$ является связным, значит ребро $f$ не явялется мостом. Из этого следует, что $f$ - принадлежит некоторому циклу, что протеворечит условию ацикличности графа $G$. Значит, предположение о существовании двух простый $(u,v)$-цепей неверно. Единственность доказана

$4) \implies 5)$

По условию нам дано, что у $\forall u,v \in VG \, \exists! \, \text{ простая }(u,v)\text{-цепь}$
. Из этого (в основном из единственности) слудует ацикличность графа.

Добавим ребро $e=uv$. В графе появится цикл, состоящий из простой $(u,v)$-цепи и ребра $e$. Единственность слудет из единственности простой цепи.

$5) \implies 1)$

Из условия следует, что граф $G$ - связен. Добавим ацикличность и получим, что граф $G$ - дерево

___

<u>Следствие 1</u>

Неодноэлементное дерево имеет по крайней мере две висячие вершины

<u>Док-во</u>

(о/п)

Пусть дерево имеет $< 2$ висячих вершин. То есть как максимум, у одной из вершин $\text{deg}\,v = 1$,  в то время как у остальных вершин $\text{deg}\,v \ge 2$. Тогда по лемме у рукопожатиях:

$$
 2(n - 1) = [\text{по теореме 2.1}] = 2m = \sum_{v \in VG} \text{dev}\,v \ge 2(n-1) + 1
$$

Противоречие, значит висячих вершин как минимум 2.

&nbsp;

<u>Лемма 1</u>

Пусть $G$ - произвольный $(n, m, k)$-граф. $G$ явялется лесом тогда и только тогда, когда $m = n - k$

<u>Док-во</u>

$\implies$

$G$ - лес. ТОгда каждая компонента связности $G$ - дерево, для которого имеет место: $m_i = n_i - 1$. Всего копонент связности (по условию) - $k$. Просуммировав число ребер каждой компоненты связности, получим:

$$
m = m_1 + m_2 + \cdots + m_k = n - k
$$

$\impliedby$

(о/п)

Пусть $G$ - не лес, значит $G$ содержит как минимум один цикл (по определению леса). Тогда, отбросив $\ge 1$ ребро, получим подграф являющийся $(n, m_1, k)$-лесом. Тогда

$$
m > m_1 = [\text{просуммируем ребра всех компонент связности - лесов}] = n - k
$$

Получили противоречие, значит $G$ - лес

&nbsp;

Возьмем некоторый связный граф $G$. Если $G$ содержит хотя бы один цикл, то при удалении
некоторого ребра, мы  уменьшим число циклов по крайней мере на 1, сохранив связность графа.
Разрушая циклы данного графа, мы когда-то придем к остовному подграфу, который будет деревом
(без циклов). Такой подграф называется **остовным деревом**. Число ребер, такого остовного дерева будет равняться $n - 1$. Значит, для получения остовного дерева нам нужно удалить
$m - n + 1$ вершин.




Теперь граф $G$ будет произвольным $(n,m,k)$-графом. Тогда объединение остовных деревьев данного
графа назовем **остовным лесом** или просто **остовом**. Поскольку такой лес будет содержать
$n - k$ ребер, то нам надо удалить $m - n + k$ для получения остова.


+ Число $r^*(G) = m - n + k$ называется **цикломатическим числом** $G$
+ Число $r(G) = n - k$ называется **рангом** $G$

&nbsp;

<u>Лемма 2</u>

Пусть $G$ - проивзольный граф. Тогда

1. $G$ ацикличен $\iff$ $r^*(G) = 0$
2. $G$ содержит единственный цикл $\iff$ $r^*(G) = 1$

&nbsp;

<u>Лемма 3</u>

Любой аицлический подграф графа $G$ содержится в некотором его остове

&nbsp;

<u>Лемма 4</u>

Пусть $S$ и $T$ - остоы графа $G$. Для некоторого ребра $e \in ES$ существует такое ребро $f \in ET$, что подграф $s - e + f$ является остовом