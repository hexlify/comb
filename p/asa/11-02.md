---
layout: default
title: 02.11.2018
folder: asa
---

# {{ page.title }}

В начале была не совсем понятная идея:

*В прошлой лекции мы рассмотрели поиск $M$-чередующейся цепи в произвольном графе $G$. Такая задача решается
простым поиском (в глубину, в ширину - неважно). Проблема такого похода в том, что нахождение такой
цепи зависит от случайного выбора начальной вершины. И это плохо, а тогда давай здесь и далее говорить
только о двудольных графах. А давайте!*

&nbsp;

<u>Опр</u>

**Цветок** - чередующийся (ребро темное/светлое) цикл нечетной длины.

&nbsp;

Далее возвратимся к задаче о поиске $M$-чередующейся цепи в графе $G$. Высказывается такая идея:

Если при поиске $M$-чередующейся цепи встречается цветок, то "сожмем" его в одну вершину и посчитаем эту
вершину светлой.

<img src="https://i.imgur.com/VPuwpeb.png" alt="Пример1">

То есть нам надо уметь "сжимать" цветки. Для этого существует так называемый алгоритм Эдмондса (1965).
Его работу мы рассматривать в курсе не будем

## Паросочетания в двудольных графах

Пусть $G = (X, Y, E)$, где $X,Y$ - левая и правая доли соответственно.

&nbsp;

<u>Теорема</u>

Граф $(V,E)$ - двудолен $\iff$ все циклы имеют четную длину

<u>Док-во</u>

[Тут](../cmb/12.html#теорема-12-кёнига)


&nbsp;

Будем считать, что матрица смежности двудольного графа имеет размер $\|X\| \times \|Y\|$

<img src="https://i.imgur.com/UXa2Tqb.jpg" alt="Пример2">

$$
    A [x, y] =
        \begin{cases}
            1, xy \in E \\
            0, xy \notin E
        \end{cases}
$$

## Алгоритм поиска $M$-чередующейся цепи из заданной вершины

ПВГ (Поиск В Глубину)

1. <u>Начало</u>

    Любая светлая вершина $x \in X$

2. <u>Движение</u>

    + слева (из $X$) направо (в $Y$) - по любому светлому ребру
    + справа налево - по любому темному ребру

3. <u>Окончание</u>

    Как только помечена (посещена) светлая вершина $y \in Y$


<u>Пример</u>

<img src="https://i.imgur.com/wkxZwNA.jpg" alt="Пример3">


&nbsp;

Тогда, нетрудно сделать вывод, что
[простой алгоритм поиска наибольшего паросочетания в двудольном графе](./10-26.html#простой-алгоритм-построения-наибольшего-паросочетания)
бдуте работать за $O(n^3)$

На самом деле за $O(\|X\| \times \|Y\| \times min(\|X\|,\|Y\|))$, где:
+ $\|X\| \times \|Y\|$ - количество итерация цикла по поиску $M$-чередующейся цепи
+ $min(\|X\|,\|Y\|)$ - количество итераций основного цикла алгоритма

Рассмотрим еще один алгоритм поиска наибольшего паросочетания (этот будет уже <u>непростым</u>)

## Алгоритм Хопкрофта-Карпа

Работает за $O(n^{\frac{5}{2}})$. Основаня идея: увеличивать паросочетание не вдоль одной цепи, а вдоль
многих сразу

Пусть $G(X, Y, E)$ - двудольный граф, а $M$ - некое его паросочетание

&nbsp;

<u>Опр</u>

Чередующаяся последовательность называется **$M$-цепью**, если

+ она начинаетс в светлой вершине $x \in X$
+ цвета ребер чередуются (светлое - темное)

Отличие от $M$-чередующейся цепи заключается в том, что нам не важен цвет и принадлежность
(она может быть равна $x$) последней вершины

<img src="https://i.imgur.com/h7skbU3.png" alt="Пример4">

&nbsp;

<u>Опр</u>

Максимальное по включению множество различных $M$-чередующихся цепей нахывается **$M$-множество**.

(цепи различные если они не пересекаются по вершинам)

&nbsp;

<u>Опр</u>

Через $G(M)$, где $M$ - некое паросочетание графа $G$, обозначим вспомогательный граф, образованный
всеми вершинами и ребрами, входящими в какую-то $M$-цепь, среди которых есть <u>кратчайшая</u>
$M$-чередующаяся цепь.

Если же $M$-чередующихся цепей нет, то $G(M) = \emptyset$

<img src="https://i.imgur.com/I6qhiT5.jpg" alt="Пример5">

<img src="https://i.imgur.com/G2SmNOZ.jpg" alt="Пример6">


### Алгоритм

1. $M := \emptyset$
2. Построить $G(M)$
3. <u>Если</u> $G(M) \ne \emptyset$, то
4. Построить $M$-множество $K$, где $K = \{p_0, \dots , p_k\}$
5. Положить $M = M \oplus p_0 \oplus \dots \oplus p_k$ и перейти на шиг 2)
6. <u>Иначе</u> СТОП


### Процедура построения $G(M)$

<u>Метод:</u> поиск в ширину (ПВШ)

<u>Начало:</u> любая светлая вершина

Введем такое понятие как **фронт** ($F_i$). $F_0$ - все светлые вершины $x \in X$

<u>Движение</u>

Пусть $F_{2k}$ - последний построенный фронт. Тогда включим в $F_{2k + 1}$ все непомеченные вершины
$y \in Y$, достигаемые по светлым ребрам из фрона $F_{2k}$. То есть:

$$
    F_{2k + 1} = \{ y \in Y: \,y \notin \bigcup_{i=0}^{2k} F_i,\, \exists x \in F_{2k},\, xy \in E,\, xy \text{ - светлое}\}
$$

Тогда в $F_{2k + 2}$ пойдут все непомеченные вершины $x \in X$, которые достигаются по темному ребру из фронта $F_{2k+1}$. То есть:

$$
    F_{2k + 2} = \{ x \in X: \,x \notin \bigcup_{i=0}^{2k + 1} F_i,\, \exists y \in F_{2k + 1},\, xy \in E,\, xy \text{ - темное}\}
$$

<u>Окончание</u>

Полное построение такого фронта $F_{2k + 1}$, в котором в <u>первый</u> раз встретилась светлая вершина
$y \in Y$.

Тогда $G(M) = \displaystyle \bigcup_{i = 0}^{2k + 1} F_i,\, E_i$, где $E_i$ - все ребра
соединяющие вершины из $F_i$ и $F_{i + 1}$

<img src="https://i.imgur.com/e9Osuns.jpg" alt="Пример7">